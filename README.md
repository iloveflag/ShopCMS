# env:
    java version "1.8.0_291"
    mysql-connector-java 8.0.24
    mysql  Ver 14.14 Distrib 5.7.33,
    apache-tomcat-8.5.0
# mermaid:
``` mermaid
graph LR
A1[购物车页面] --> B1(查询所有选购商品)
A1[购物车页面] --> B2(清空购物车)
A1[购物车页面] --> B3(改变商品数量)
    B3 --> C1{判断数量}
        C1 --> |>0|D1(更新)
        C1 --> |=0|D2(删除)
        C1 --> |<0|D3(异常抛出)
A1[购物车页面] --> B4(减少商品)
    B4-->C2{原有数量}
        C2-->|>1|D4(减少)
        C2-->|<=1|B5
A1[购物车页面] --> B6(增加商品)
A1 -->B5(删除这件商品的选择)
A2[商品详情页面] --> B6(增加商品)
        B6-->C3{增加数目}
        C3-->|>=0|D6{表中是否有记录}
            D6-->|有|E1(更新)
            D6-->|无|E2(新增)
        C3-->|<0|D7(异常抛出)
A2-->B7(查询商品信息)
A2-->B8(减少库存)
A3[订单页面] -->B9(查询)
	B9-->C4{购物车是否为空}
        C4-->|不为空|D8{库存是否充足}
        	D8-->|库存充足|E3(显示价格)
        		E3-->B10
        	D8-->|库存不足|E4(跳转查询库存信息)
        C4-->|为空|D9(跳转购物车)
A3[订单页面] -->B10(结算-支付网关暂未接入)
	B10-->B1{查询所有商品}
		B1-->|有|B8-->B2
		B1-->|无|D10(异常抛出)
A4[用户页面]-->B11(登录)
A4[用户页面]-->B12(注册)
```

# 遇到的问题

## 1.ResourceBundle.getBundle获取不到类信息，缓存机制更新经常出错

   actionMapping.properties放在根目录下，ResourceBundle rb = null;清除缓存

## 2.购买数量超过库存数量，支付成功没有减少库存

   加入判断功能

## 3.用户越权操作，加入购物车没有生成订单，直接结算成功，库存不足导致库存变为负数

   添加用户商品检查和库存检验

## 4.部署到服务器出现数据库无法连接，路径出错问题

   统一java版本和mysql-coonnect版本

## 5.xss未修复